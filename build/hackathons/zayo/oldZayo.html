<h1 id="zayo">Zayo</h1>
<h2 id="menu">Menu</h2>
<h3 id="group-by">Group By</h3>
<div style="border:1px grey solid; padding:5px;">
<button id="viz-college">Group By College</button>
</div>

<div style="border:1px grey solid; padding:5px;">
Field: <input id="group-by-attribute" type="text" value="CrsPBAColl"/>
<button id="viz-group-by-attribute">Group By</button>
</div>


<h2 id="viz">Viz</h2>
<div class="myviz" style="width:100%; height:500px; border: 1px black solid;">
Data is not loaded yet
</div>

<p>{% script %}
// zayoData is a global variable
zayoData = ‘not loaded yet’</p>
<p>$.get(‘zayo.json’)
 .success(function(data){
     console.log(‘data loaded’, data)
     // Show in the myviz that the data is loaded
     $(‘.myviz’).html(‘number of records load:’ + data.length)
     zayoData = data<br> })</p>
<p>function vizCustomer(){</p>
<pre><code>// process zayoData

var groups = _.groupBy(fcqData, function(d){
    return d[&#39;CrsPBAColl&#39;]
})

var dataArray = _.map(_.pairs(groups), function(p){
    return {name: p[0], count: p[1].length}
})

console.log(&#39;dataArray&#39;, dataArray)


// define a template string
var tplString = &#39;&lt;g transform=&quot;translate(0 ${d.y})&quot;&gt; \
                &lt;rect   \
                     width=&quot;${d.width}&quot; \
                     height=&quot;20&quot;    \
                     style=&quot;fill:${d.color};    \
                            stroke-width:3; \
                            stroke:rgb(0,0,0)&quot; /&gt;   \
                &lt;/g&gt;&#39;

// compile the string to get a template function
var template = _.template(tplString)

function computeX(d, i) {
    return 0
}

function computeWidth(d, i) {
    return d[&#39;count&#39;] / 5
}

function computeY(d, i) {
    return i * 20
}

function computeColor(d, i) {
    return &#39;red&#39;
}

var viz = _.map(dataArray, function(d, i){
            return {
                x: computeX(d, i),
                y: computeY(d, i),
                width: computeWidth(d, i),
                color: computeColor(d, i)
            }
         })
console.log(&#39;viz&#39;, viz)

var result = _.map(viz, function(d){
         // invoke the compiled template function on each viz data
         return template({d: d})
     })
console.log(&#39;result&#39;, result)

$(&#39;.myviz&#39;).html(&#39;&lt;svg width=&quot;100%&quot; height=&quot;100%&quot;&gt;&#39; + result + &#39;&lt;/svg&gt;&#39;)
</code></pre><p>}</p>
<p>$(‘button#viz-college’).click(vizCollege)</p>
<p>// TODO: complete the code below
// 1. Each horizontal bar should have a label
// 2. Each horizontal bar should have a number indicating the count</p>
<p>function vizGroupByAttribute(attributeName){</p>
<pre><code>// process fcqData

var groups = _.groupBy(fcqData, function(d){
    return d[attributeName]
})

var dataArray = _.map(_.pairs(groups), function(p){
    return {name: p[0], count: p[1].length}
})

console.log(&#39;dataArray&#39;, dataArray)


// define a template string
var tplString = &#39;&lt;g transform=&quot;translate(0 ${d.y})&quot;&gt;      \
                &lt;rect                                     \
                     width=&quot;${d.width}&quot;                   \
                     height=&quot;20&quot;                          \
                     style=&quot;fill:${d.color};              \
                            stroke-width:3;               \
                            stroke:rgb(0,0,0)&quot; /&gt;         \
                      &lt;text transform=&quot;translate(0 15)&quot;&gt;  \
                         ${d.label}                       \
                     &lt;/text&gt;                              \
                &lt;/g&gt;&#39;

// compile the string to get a template function
var template = _.template(tplString)

function computeX(d, i) {
    return 0
}

function computeWidth(d, i) {
    return d[&#39;count&#39;] / 5
}

function computeY(d, i) {
    return i * 20
}

function computeColor(d, i) {
    return &#39;red&#39;
}

function computeLabel(d, i) {
    var label = d.name + &quot;: &quot; + d[&#39;count&#39;]
    return label
}

var viz = _.map(dataArray, function(d, i){
            return {
                x: computeX(d, i),
                y: computeY(d, i),
                width: computeWidth(d, i),
                label: computeLabel(d, i),
                color: computeColor(d, i)
            }
         })
console.log(&#39;viz&#39;, viz)

var result = _.map(viz, function(d){
         // invoke the compiled template function on each viz data
         return template({d: d})
     })
console.log(&#39;result&#39;, result)

$(&#39;.myviz&#39;).html(&#39;&lt;svg width=&quot;100%&quot; height=&quot;100%&quot;&gt;&#39; + result + &#39;&lt;/svg&gt;&#39;)
</code></pre><p>}</p>
<p>$(‘button#viz-group-by-attribute’).click(function(){<br>    var attributeName = $(‘input#group-by-attribute’).val()
    vizGroupByAttribute(attributeName)
})  </p>
<p>{% endscript %}</p>
